A version that uses `#[no_std]`, to try to get the C/++ implementation
and Rust implementations as close to each other as possible, for
performance comparisons.
